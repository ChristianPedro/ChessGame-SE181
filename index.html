<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <style>
      * {
        margin: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
      }

      #outer {
        display: table;
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
      }

      #table {
        display: table-cell;
        vertical-align: middle;
      }

      #container {
        position: relative;
        padding: 5px;
        border: 5px solid gray;
        display: inline-block;
        margin: auto;
        left: 50%;
        transform: translateX(-50%);
        padding-right: 10px;
      }

      #container > div > div {
        width: 50px;
        height: 50px;
        display: inline-block;
        vertical-align: top;
        margin-right: -5px;
    }

      .black {
        background-color: black;
        color: white;
      }

      .white {
        background-color: white;
      }

      .black, .white {
          transition: 0.075s all;
          text-align: center;
		  line-height: 50px;
		  font-size: 1.5rem;
      }

      .black:hover, .white:hover {
          background-color: gray;
      }
    </style>
    <div id="outer">
      <div id="table">
        <div id="container">
          <div class="row">
            <div id="a1" class="black"></div>
            <div id="a2" class="white"></div>
            <div id="a3" class="black"></div>
            <div id="a4" class="white"></div>
            <div id="a5" class="black"></div>
            <div id="a6" class="white"></div>
            <div id="a7" class="black"></div>
            <div id="a8" class="white"></div>
          </div>
          <div class="row">
            <div id="b1" class="white"></div>
            <div id="b2" class="black"></div>
            <div id="b3" class="white"></div>
            <div id="b4" class="black"></div>
            <div id="b5" class="white"></div>
            <div id="b6" class="black"></div>
            <div id="b7" class="white"></div>
            <div id="b8" class="black"></div>
          </div>
          <div class="row">
            <div id="c1" class="black"></div>
            <div id="c2" class="white"></div>
            <div id="c3" class="black"></div>
            <div id="c4" class="white"></div>
            <div id="c5" class="black"></div>
            <div id="c6" class="white"></div>
            <div id="c7" class="black"></div>
            <div id="c8" class="white"></div>
        </div>
        <div class="row">
            <div id="d1" class="white"></div>
            <div id="d2" class="black"></div>
            <div id="d3" class="white"></div>
            <div id="d4" class="black"></div>
            <div id="d5" class="white"></div>
            <div id="d6" class="black"></div>
            <div id="d7" class="white"></div>
            <div id="d8" class="black"></div>
        </div>
        <div class="row">
            <div id="e1" class="black"></div>
            <div id="e2" class="white"></div>
            <div id="e3" class="black"></div>
            <div id="e4" class="white"></div>
            <div id="e5" class="black"></div>
            <div id="e6" class="white"></div>
            <div id="e7" class="black"></div>
            <div id="e8" class="white"></div>
        </div>
        <div class="row">
            <div id="f1" class="white"></div>
            <div id="f2" class="black"></div>
            <div id="f3" class="white"></div>
            <div id="f4" class="black"></div>
            <div id="f5" class="white"></div>
            <div id="f6" class="black"></div>
            <div id="f7" class="white"></div>
            <div id="f8" class="black"></div>
        </div>
        <div class="row">
            <div id="g1" class="black"></div>
            <div id="g2" class="white"></div>
            <div id="g3" class="black"></div>
            <div id="g4" class="white"></div>
            <div id="g5" class="black"></div>
            <div id="g6" class="white"></div>
            <div id="g7" class="black"></div>
            <div id="g8" class="white"></div>
        </div>
        <div class="row">
            <div id="h1" class="white"></div>
            <div id="h2" class="black"></div>
            <div id="h3" class="white"></div>
            <div id="h4" class="black"></div>
            <div id="h5" class="white"></div>
            <div id="h6" class="black"></div>
            <div id="h7" class="white"></div>
            <div id="h8" class="black"></div>
        </div>
      </div>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script>
		    var socket = io();
    let start = undefined;
    for (let row of document.getElementsByClassName("row")) {
      row.addEventListener('click', function(e) {
        e = e || window.event;
        var target = e.target || e.srcElement, text = target.textContent || target.innerText;
        if (target.id){
          if(start && !text){
            socket.emit('move-piece', {
              start: start,
              end: target.id
            });
            //console.log(`sent packet: ${start} to ${target.id}`,)
            start = undefined;
            location.reload();
          }
          else if(text){
            start = target.id;
            //console.log(`first position: ${start}`)
          }
        }
      }, false);
    }
    socket.on('update', data => {
      //console.log('logged update event', data.board);
      for(let [key, value] of Object.entries(data.board)){
        document.getElementById(key).innerHTML = value;
      }
    });
    </script>
  </body>
</html>
